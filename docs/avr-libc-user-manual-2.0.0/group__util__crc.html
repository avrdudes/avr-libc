<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>avr-libc: &lt;util/crc16.h&gt;: CRC Computations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dox.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">avr-libc
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">Standard C library for AVR-GCC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table>
  <tr>
    <td align="left"><a href="http://www.nongnu.org/avr-libc/"><h2>AVR Libc Home Page</h2></a></td>
    <td align="center" colspan=4><img src="avrs.png" alt="AVRs" align="middle" border="0"></td>
    <td align="right"><a href="https://savannah.nongnu.org/projects/avr-libc/"><h2>AVR Libc Development Pages</h2></a></td>
  </tr>
  <tr>
    <td align="center" width="20%"><a href="index.html"><h2>Main Page</h2></a></td>
    <td align="center" width="20%"><a href="pages.html"><h2>User Manual</h2></a></td>
    <td align="center" width="20%"><a href="modules.html"><h2>Library Reference</h2></a></td>
    <td align="center" width="20%"><a href="FAQ.html"><h2>FAQ</h2></a></td>
    <td align="center" width="20%"><a href="group__demos.html"><h2>Example Projects</h2></a></td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">&lt;util/crc16.h&gt;: CRC Computations</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga95371c87f25b0a2497d9cba13190847f"><td class="memItemLeft" align="right" valign="top">static __inline__ <a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__crc.html#ga95371c87f25b0a2497d9cba13190847f">_crc16_update</a> (<a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> __crc, <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __data)</td></tr>
<tr class="separator:ga95371c87f25b0a2497d9cba13190847f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca726c22a1900f9bad52594c8846115f"><td class="memItemLeft" align="right" valign="top">static __inline__ <a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__crc.html#gaca726c22a1900f9bad52594c8846115f">_crc_xmodem_update</a> (<a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> __crc, <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __data)</td></tr>
<tr class="separator:gaca726c22a1900f9bad52594c8846115f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c1d3ad875310cbc58000e24d981ad20"><td class="memItemLeft" align="right" valign="top">static __inline__ <a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__crc.html#ga1c1d3ad875310cbc58000e24d981ad20">_crc_ccitt_update</a> (<a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> __crc, <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __data)</td></tr>
<tr class="separator:ga1c1d3ad875310cbc58000e24d981ad20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37b2f691ebbd917e36e40b096f78d996"><td class="memItemLeft" align="right" valign="top">static __inline__ <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__crc.html#ga37b2f691ebbd917e36e40b096f78d996">_crc_ibutton_update</a> (<a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __crc, <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __data)</td></tr>
<tr class="separator:ga37b2f691ebbd917e36e40b096f78d996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab27eaaef6d7fd096bd7d57bf3f9ba083"><td class="memItemLeft" align="right" valign="top">static __inline__ <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__crc.html#gab27eaaef6d7fd096bd7d57bf3f9ba083">_crc8_ccitt_update</a> (<a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __crc, <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> __data)</td></tr>
<tr class="separator:gab27eaaef6d7fd096bd7d57bf3f9ba083"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="crc16_8h.html">util/crc16.h</a>&gt;</span></div>
</div><!-- fragment --><p>This header file provides a optimized inline functions for calculating cyclic redundancy checks (CRC) using common polynomials.</p>
<dl class="section user"><dt>References:</dt><dd></dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<p>See the Dallas Semiconductor app note 27 for 8051 assembler example and general CRC optimization suggestions. The table on the last page of the app note is the key to understanding these implementations.</p>
<dl class="section user"><dt></dt><dd></dd></dl>
<p>Jack Crenshaw's "Implementing CRCs" article in the January 1992 isue of <em>Embedded</em> <em>Systems</em> <em>Programming</em>. This may be difficult to find, but it explains CRC's in very clear and concise terms. Well worth the effort to obtain a copy.</p>
<p>A typical application would look like:</p>
<div class="fragment"><div class="line"><span class="comment">// Dallas iButton test vector.</span></div>
<div class="line"><a class="code" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> serno[] = { 0x02, 0x1c, 0xb8, 0x01, 0, 0, 0, 0xa2 };</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">checkcrc(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><a class="code" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> crc = 0, i;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span> serno / <span class="keyword">sizeof</span> serno[0]; i++)</div>
<div class="line">    crc = <a class="code" href="group__util__crc.html#ga37b2f691ebbd917e36e40b096f78d996">_crc_ibutton_update</a>(crc, serno[i]);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">return</span> crc; <span class="comment">// must be 0</span></div>
<div class="line">}</div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga95371c87f25b0a2497d9cba13190847f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ <a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> _crc16_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>__crc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Optimized CRC-16 calculation.</p>
<p>Polynomial: x^16 + x^15 + x^2 + 1 (0xa001)<br />
 Initial value: 0xffff</p>
<p>This CRC is normally used in disk-drive controllers.</p>
<p>The following is the equivalent functionality written in C.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;uint16_t</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;crc16_update(uint16_t crc, uint8_t a)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;int i;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;crc ^= a;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;for (i = 0; i &lt; 8; ++i)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    if (crc &amp; 1)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;   crc = (crc &gt;&gt; 1) ^ 0xA001;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    else</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;   crc = (crc &gt;&gt; 1);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;}</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;return crc;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gab27eaaef6d7fd096bd7d57bf3f9ba083"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> _crc8_ccitt_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__crc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Optimized CRC-8-CCITT calculation.</p>
<p>Polynomial: x^8 + x^2 + x + 1 (0xE0)<br />
</p>
<p>For use with simple CRC-8<br />
 Initial value: 0x0</p>
<p>For use with CRC-8-ROHC<br />
 Initial value: 0xff<br />
 Reference: <a href="http://tools.ietf.org/html/rfc3095#section-5.9.1">http://tools.ietf.org/html/rfc3095#section-5.9.1</a></p>
<p>For use with CRC-8-ATM/ITU<br />
 Initial value: 0xff<br />
 Final XOR value: 0x55<br />
 Reference: <a href="http://www.itu.int/rec/T-REC-I.432.1-199902-I/en">http://www.itu.int/rec/T-REC-I.432.1-199902-I/en</a></p>
<p>The C equivalent has been originally written by Dave Hylands. Assembly code is based on _crc_ibutton_update optimization.</p>
<p>The following is the equivalent functionality written in C.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;uint8_t</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;_crc8_ccitt_update (uint8_t inCrc, uint8_t inData)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    uint8_t   i;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    uint8_t   data;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    data = inCrc ^ inData;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    for ( i = 0; i &lt; 8; i++ )</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        if (( data &amp; 0x80 ) != 0 )</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            data &lt;&lt;= 1;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            data ^= 0x07;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        else</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;            data &lt;&lt;= 1;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        }</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    return data;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga1c1d3ad875310cbc58000e24d981ad20"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ <a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> _crc_ccitt_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>__crc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Optimized CRC-CCITT calculation.</p>
<p>Polynomial: x^16 + x^12 + x^5 + 1 (0x8408)<br />
 Initial value: 0xffff</p>
<p>This is the CRC used by PPP and IrDA.</p>
<p>See RFC1171 (PPP protocol) and IrDA IrLAP 1.1</p>
<dl class="section note"><dt>Note</dt><dd>Although the CCITT polynomial is the same as that used by the Xmodem protocol, they are quite different. The difference is in how the bits are shifted through the alorgithm. Xmodem shifts the MSB of the CRC and the input first, while CCITT shifts the LSB of the CRC and the input first.</dd></dl>
<p>The following is the equivalent functionality written in C.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;uint16_t</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;crc_ccitt_update (uint16_t crc, uint8_t data)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    data ^= lo8 (crc);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    data ^= data &lt;&lt; 4;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    return ((((uint16_t)data &lt;&lt; 8) | hi8 (crc)) ^ (uint8_t)(data &gt;&gt; 4) </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            ^ ((uint16_t)data &lt;&lt; 3));</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga37b2f691ebbd917e36e40b096f78d996"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ <a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> _crc_ibutton_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__crc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Optimized Dallas (now Maxim) iButton 8-bit CRC calculation.</p>
<p>Polynomial: x^8 + x^5 + x^4 + 1 (0x8C)<br />
 Initial value: 0x0</p>
<p>See <a href="http://www.maxim-ic.com/appnotes.cfm/appnote_number/27">http://www.maxim-ic.com/appnotes.cfm/appnote_number/27</a></p>
<p>The following is the equivalent functionality written in C.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;uint8_t</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;_crc_ibutton_update(uint8_t crc, uint8_t data)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;uint8_t i;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;crc = crc ^ data;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;for (i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    if (crc &amp; 0x01)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        crc = (crc &gt;&gt; 1) ^ 0x8C;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    else</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        crc &gt;&gt;= 1;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;}</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;return crc;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaca726c22a1900f9bad52594c8846115f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline__ <a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> _crc_xmodem_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#ga1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>__crc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__avr__stdint.html#gaba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>__data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Optimized CRC-XMODEM calculation.</p>
<p>Polynomial: x^16 + x^12 + x^5 + 1 (0x1021)<br />
 Initial value: 0x0</p>
<p>This is the CRC used by the Xmodem-CRC protocol.</p>
<p>The following is the equivalent functionality written in C.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;uint16_t</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;crc_xmodem_update (uint16_t crc, uint8_t data)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    int i;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    crc = crc ^ ((uint16_t)data &lt;&lt; 8);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    for (i=0; i&lt;8; i++)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        if (crc &amp; 0x8000)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;            crc = (crc &lt;&lt; 1) ^ 0x1021;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        else</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            crc &lt;&lt;= 1;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    }</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    return crc;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 8 2016 23:59:03 for avr-libc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
