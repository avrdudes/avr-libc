<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<title>AVR-LibC: &lt;util/setbaud.h&gt;: Helper macros for baud rate calculations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dox.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AVR-LibC
   &#160;<span id="projectnumber">2.3.0git</span>
   </div>
   <div id="projectbrief">Standard C library for AVR-GCC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table>
  <tr>
    <td align="left"><a href="https://avrdudes.github.io/avr-libc/"><h2>AVR-LibC Documen&shy;tation</h2></a></td>
    <td align="center" colspan=4>
      <div class="logo"><img src="avr-libc-logo.png" alt="Logo" align="middle" border="0"></div>
      <div class="invlogo"><img src="avr-libc-logo-inverted.png" alt="Logo" align="middle" border="0"></div>
    </td>
    <td align="right" colspan=2><a href="https://github.com/avrdudes/avr-libc/"><h2>AVR-LibC Development Pages</h2></a></td>
  </tr>
  <tr>
    <td align="center" width="15%"><a href="index.html"><h2>Main Page</h2></a></td>
    <td align="center" width="15%"><a href="pages.html"><h2>User Manual</h2></a></td>
    <td align="center" width="15%"><a href="modules.html"><h2>Library Refe&shy;rence</h2></a></td>
    <td align="center" width="8%"><a href="FAQ.html"><h2>FAQ</h2></a></td>
    <td align="center" width="15%"><a href="group__demos.html"><h2>Example Projects</h2></a></td>
    <td align="center" width="8%"><a href="files.html"><h2>File List</h2></a></td>
    <td align="center" width="8%"><a href="Global_01Index.html"><h2>Index</h2></a></td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">&lt;util/setbaud.h&gt;: Helper macros for baud rate calculations</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gaddaa61b72aca51ed4835978d500f8755"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__setbaud.html#gaddaa61b72aca51ed4835978d500f8755">BAUD_TOL</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:gaddaa61b72aca51ed4835978d500f8755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b029ff580b042a27aaac4bd2ec925e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__setbaud.html#ga0b029ff580b042a27aaac4bd2ec925e2">UBRR_VALUE</a></td></tr>
<tr class="separator:ga0b029ff580b042a27aaac4bd2ec925e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39ebec5d04e582b7b6ed9a72b973983c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__setbaud.html#ga39ebec5d04e582b7b6ed9a72b973983c">UBRRL_VALUE</a></td></tr>
<tr class="separator:ga39ebec5d04e582b7b6ed9a72b973983c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8188daef772f5eb3fc81dfee168905e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__setbaud.html#ga8188daef772f5eb3fc81dfee168905e2">UBRRH_VALUE</a></td></tr>
<tr class="separator:ga8188daef772f5eb3fc81dfee168905e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6977ce48ae3197f3f016b85d98380509"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__util__setbaud.html#ga6977ce48ae3197f3f016b85d98380509">USE_2X</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ga6977ce48ae3197f3f016b85d98380509"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#define F_CPU 11059200</span></div>
<div class="line"><span class="preprocessor">#define BAUD 38400</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="setbaud_8h.html">util/setbaud.h</a>&gt;</span></div>
<div class="ttc" id="asetbaud_8h_html"><div class="ttname"><a href="setbaud_8h.html">setbaud.h</a></div></div>
</div><!-- fragment --><p>This header file requires that on entry values are already defined for F_CPU and BAUD. In addition, the macro BAUD_TOL will define the baud rate tolerance (in percent) that is acceptable during the calculations. The value of BAUD_TOL will default to 2 %.</p>
<p>This header file defines macros suitable to setup the UART baud rate prescaler registers of an AVR. All calculations are done using the C preprocessor. Including this header file causes no other side effects so it is possible to include this file more than once (supposedly, with different values for the BAUD parameter), possibly even within the same function.</p>
<p>Assuming that the requested BAUD is valid for the given F_CPU then the macro UBRR_VALUE is set to the required prescaler value. Two additional macros are provided for the low and high bytes of the prescaler, respectively: UBRRL_VALUE is set to the lower byte of the UBRR_VALUE and UBRRH_VALUE is set to the upper byte. An additional macro USE_2X will be defined. Its value is set to 1 if the desired BAUD rate within the given tolerance could only be achieved by setting the U2X bit in the UART configuration. It will be defined to 0 if U2X is not needed.</p>
<p>Example usage:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="io_8h.html">avr/io.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define F_CPU 4000000</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">uart_9600(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define BAUD 9600</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="setbaud_8h.html">util/setbaud.h</a>&gt;</span></div>
<div class="line">    UBRRH = <a class="code hl_define" href="group__util__setbaud.html#ga8188daef772f5eb3fc81dfee168905e2">UBRRH_VALUE</a>;</div>
<div class="line">    UBRRL = <a class="code hl_define" href="group__util__setbaud.html#ga39ebec5d04e582b7b6ed9a72b973983c">UBRRL_VALUE</a>;</div>
<div class="line"><span class="preprocessor">#if USE_2X</span></div>
<div class="line">    UCSRA |= (1 &lt;&lt; U2X);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    UCSRA &amp;= ~(1 &lt;&lt; U2X);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">uart_38400(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#undef BAUD  </span><span class="comment">// avoid compiler warning</span></div>
<div class="line"><span class="preprocessor">#define BAUD 38400</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="setbaud_8h.html">util/setbaud.h</a>&gt;</span></div>
<div class="line">    UBRRH = <a class="code hl_define" href="group__util__setbaud.html#ga8188daef772f5eb3fc81dfee168905e2">UBRRH_VALUE</a>;</div>
<div class="line">    UBRRL = <a class="code hl_define" href="group__util__setbaud.html#ga39ebec5d04e582b7b6ed9a72b973983c">UBRRL_VALUE</a>;</div>
<div class="line"><span class="preprocessor">#if USE_2X</span></div>
<div class="line">    UCSRA |= (1 &lt;&lt; U2X);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    UCSRA &amp;= ~(1 &lt;&lt; U2X);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__util__setbaud_html_ga39ebec5d04e582b7b6ed9a72b973983c"><div class="ttname"><a href="group__util__setbaud.html#ga39ebec5d04e582b7b6ed9a72b973983c">UBRRL_VALUE</a></div><div class="ttdeci">#define UBRRL_VALUE</div><div class="ttdef"><b>Definition:</b> setbaud.h:158</div></div>
<div class="ttc" id="agroup__util__setbaud_html_ga8188daef772f5eb3fc81dfee168905e2"><div class="ttname"><a href="group__util__setbaud.html#ga8188daef772f5eb3fc81dfee168905e2">UBRRH_VALUE</a></div><div class="ttdeci">#define UBRRH_VALUE</div><div class="ttdef"><b>Definition:</b> setbaud.h:169</div></div>
<div class="ttc" id="aio_8h_html"><div class="ttname"><a href="io_8h.html">io.h</a></div></div>
</div><!-- fragment --><p>In this example, two functions are defined to setup the UART to run at 9600 Bd, and 38400 Bd, respectively. Using a CPU clock of 4 MHz, 9600 Bd can be achieved with an acceptable tolerance without setting U2X (prescaler 25), while 38400 Bd require U2X to be set (prescaler 12). </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaddaa61b72aca51ed4835978d500f8755" name="gaddaa61b72aca51ed4835978d500f8755"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaddaa61b72aca51ed4835978d500f8755">&#9670;&#160;</a></span>BAUD_TOL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BAUD_TOL&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Input and output macro for &lt;<a class="el" href="setbaud_8h.html">util/setbaud.h</a>&gt;</p>
<p>Define the acceptable baud rate tolerance in percent. If not set on entry, it will be set to its default value of 2. </p>

</div>
</div>
<a id="ga0b029ff580b042a27aaac4bd2ec925e2" name="ga0b029ff580b042a27aaac4bd2ec925e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b029ff580b042a27aaac4bd2ec925e2">&#9670;&#160;</a></span>UBRR_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UBRR_VALUE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output macro from &lt;<a class="el" href="setbaud_8h.html">util/setbaud.h</a>&gt;</p>
<p>Contains the calculated baud rate prescaler value for the UBRR register. </p>

</div>
</div>
<a id="ga8188daef772f5eb3fc81dfee168905e2" name="ga8188daef772f5eb3fc81dfee168905e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8188daef772f5eb3fc81dfee168905e2">&#9670;&#160;</a></span>UBRRH_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UBRRH_VALUE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output macro from &lt;<a class="el" href="setbaud_8h.html">util/setbaud.h</a>&gt;</p>
<p>Contains the upper byte of the calculated prescaler value (UBRR_VALUE). </p>

</div>
</div>
<a id="ga39ebec5d04e582b7b6ed9a72b973983c" name="ga39ebec5d04e582b7b6ed9a72b973983c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39ebec5d04e582b7b6ed9a72b973983c">&#9670;&#160;</a></span>UBRRL_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UBRRL_VALUE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output macro from &lt;<a class="el" href="setbaud_8h.html">util/setbaud.h</a>&gt;</p>
<p>Contains the lower byte of the calculated prescaler value (UBRR_VALUE). </p>

</div>
</div>
<a id="ga6977ce48ae3197f3f016b85d98380509" name="ga6977ce48ae3197f3f016b85d98380509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6977ce48ae3197f3f016b85d98380509">&#9670;&#160;</a></span>USE_2X</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USE_2X&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output macro from &lt;<a class="el" href="setbaud_8h.html">util/setbaud.h</a>&gt;</p>
<p>Contains the value 1 if the desired baud rate tolerance could only be achieved by setting the U2X bit in the UART configuration. Contains 0 otherwise. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 24 2025 16:09:12 for AVR-LibC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.6
</small></address>
</body>
</html>
