<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<title>AVR-LibC: Building and Installing the GNU Tool Chain</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dox.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AVR-LibC
   &#160;<span id="projectnumber">2.3.0git</span>
   </div>
   <div id="projectbrief">Standard C library for AVR-GCC</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table>
  <tr>
    <td align="left"><a href="https://avrdudes.github.io/avr-libc/"><h2>AVR-LibC Documen&shy;tation</h2></a></td>
    <td align="center" colspan=4>
      <div class="logo"><img src="avr-libc-logo.png" alt="Logo" align="middle" border="0"></div>
      <div class="invlogo"><img src="avr-libc-logo-inverted.png" alt="Logo" align="middle" border="0"></div>
    </td>
    <td align="right" colspan=2><a href="https://github.com/avrdudes/avr-libc/"><h2>AVR-LibC Development Pages</h2></a></td>
  </tr>
  <tr>
    <td align="center" width="15%"><a href="index.html"><h2>Main Page</h2></a></td>
    <td align="center" width="15%"><a href="pages.html"><h2>User Manual</h2></a></td>
    <td align="center" width="15%"><a href="modules.html"><h2>Library Refe&shy;rence</h2></a></td>
    <td align="center" width="8%"><a href="FAQ.html"><h2>FAQ</h2></a></td>
    <td align="center" width="15%"><a href="group__demos.html"><h2>Example Projects</h2></a></td>
    <td align="center" width="8%"><a href="files.html"><h2>File List</h2></a></td>
    <td align="center" width="8%"><a href="Global_01Index.html"><h2>Index</h2></a></td>
  </tr>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Building and Installing the GNU Tool Chain </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a id="a1_installation" name="a1_installation"></a></p>
<p>This chapter shows how to build and install, from source code, a complete development environment for the AVR processors using the GNU toolset. There are two main sections, one for Linux, FreeBSD, and other Unix-like operating systems, and another section for Windows.</p>
<ul>
<li><a class="el" href="install_tools.html#required_tools">Required AVR Tools</a></li>
<li><a class="el" href="install_tools.html#optional_tools">Optional AVR Tools</a></li>
<li><a class="el" href="install_tools.html#install_unix">Building and Installing under Linux, FreeBSD, and Others</a><ul>
<li><a class="el" href="install_tools.html#install_preparations">Preparations</a><ul>
<li><a class="el" href="install_tools.html#install_host_tools">Required Build Tools</a></li>
<li><a class="el" href="install_tools.html#install_dir_layout">Directory Layout</a></li>
</ul>
</li>
<li><a class="el" href="install_tools.html#install_avr_binutils">GNU Binutils</a></li>
<li><a class="el" href="install_tools.html#install_avr_gcc">GCC</a></li>
<li><a class="el" href="install_tools.html#install_avr_libc">AVR-LibC</a></li>
<li><a class="el" href="install_tools.html#install_avrprog">AVRDUDE</a></li>
<li><a class="el" href="install_tools.html#install_simulavr">SimulAVR</a></li>
<li><a class="el" href="install_tools.html#install_avarice">AVaRICE</a></li>
</ul>
</li>
<li><a class="el" href="install_tools.html#install_windows">Building and Installing under Windows</a><ul>
<li><a class="el" href="install_tools.html#install_windows_tools">Required Tools</a></li>
<li><a class="el" href="install_tools.html#install_windows_building">Building</a></li>
</ul>
</li>
<li><a class="el" href="install_tools.html#install_canadian">Canadian Cross Builds</a></li>
<li><a class="el" href="install_tools.html#using_git">Using Git</a></li>
</ul>
<h1><a class="anchor" id="required_tools"></a>
Required AVR Tools</h1>
<p><a id="a2_tools:2C:20required" name="a2_tools:2C:20required"></a></p>
<dl>
<dt>GNU Binutils </dt>
<dd><p class="startdd">Project Home: <a href="https://sourceware.org/binutils">https://sourceware.org/binutils</a> <br  />
 Source Downloads: <a href="https://sourceware.org/pub/binutils/releases">https://sourceware.org/pub/binutils/releases</a> <br  />
 FTP: anonymous@ftp.gnu.org/gnu/binutils <br  />
 Git: git://sourceware.org/git/binutils-gdb.git <br  />
 GitHub Mirror: <a href="https://github.com/bminor/binutils-gdb">https://github.com/bminor/binutils-gdb</a> <br  />
 <a class="el" href="install_tools.html#install_avr_binutils">Installation</a> </p>
<p class="enddd"></p>
</dd>
<dt>GCC </dt>
<dd><p class="startdd">Project Home <a href="https://gcc.gnu.org">https://gcc.gnu.org</a> <br  />
 Mirrors Site: <a href="https://gcc.gnu.org/mirrors.html">https://gcc.gnu.org/mirrors.html</a> <br  />
 FTP: anonymous@ftp.gnu.org/gnu/gcc <br  />
 Git: git://gcc.gnu.org/git/gcc.git <br  />
 GitHub Mirror: <a href="https://github.com/gcc-mirror/gcc">https://github.com/gcc-mirror/gcc</a> <br  />
 Installation: <a href="https://gcc.gnu.org/install">https://gcc.gnu.org/install</a> <br  />
 <a class="el" href="install_tools.html#install_avr_gcc">Installation</a> </p>
<p class="enddd"></p>
</dd>
<dt>AVR-LibC </dt>
<dd>New Project Home: <a href="https://avrdudes.github.io/avr-libc">https://avrdudes.github.io/avr-libc</a> <br  />
 New Source Downloads (&ge; v2.2): <a href="https://github.com/avrdudes/avr-libc/releases">https://github.com/avrdudes/avr-libc/releases</a> <br  />
 Git: https://github.com/avrdudes/avr-libc.git <br  />
 GitHub: <a href="https://github.com/avrdudes/avr-libc">https://github.com/avrdudes/avr-libc</a> <br  />
 Old Project Home: <a href="http://savannah.gnu.org/projects/avr-libc">http://savannah.gnu.org/projects/avr-libc</a> <br  />
 Old Source Downloads (&le; v2.1): <a href="https://download-mirror.savannah.gnu.org/releases/avr-libc">https://download-mirror.savannah.gnu.org/releases/avr-libc</a> <br  />
 <a class="el" href="install_tools.html#install_avr_libc">Installation</a>  </dd>
</dl>
<h1><a class="anchor" id="optional_tools"></a>
Optional AVR Tools</h1>
<p><a id="a3_tools:2C:20optional" name="a3_tools:2C:20optional"></a></p>
<p>You can develop programs for AVR devices without the following tools. They may or may not be of use for you.</p>
<dl>
<dt>AVRDUDE </dt>
<dd><p class="startdd">Project Home: <a href="http://savannah.nongnu.org/projects/avrdude">http://savannah.nongnu.org/projects/avrdude</a> <br  />
 Git: https://github.com/avrdudes/avrdude.git <br  />
 GitHub: <a href="https://github.com/avrdudes/avrdude">https://github.com/avrdudes/avrdude</a> <br  />
 <a class="el" href="install_tools.html#install_avrprog">Installation</a> <br  />
 <a class="el" href="using_avrprog.html">Usage Notes</a> </p>
<p class="enddd"></p>
</dd>
<dt>GDB </dt>
<dd><p class="startdd">The GNU Debugger GDB is hosted together with GNU Binutils. When you don't want or need GDB, you can configure Binutils with <code>--disable-gdb</code>. </p>
<p class="enddd"></p>
</dd>
<dt>SimulAVR </dt>
<dd><p class="startdd"><a href="http://savannah.gnu.org/projects/simulavr">http://savannah.gnu.org/projects/simulavr</a> <br  />
 <a class="el" href="install_tools.html#install_simulavr">Installation</a> </p>
<p class="enddd"></p>
</dd>
<dt>AVaRICE </dt>
<dd>GitHub: <a href="https://github.com/avrdudes/avarice">https://github.com/avrdudes/avarice</a> <br  />
 <a class="el" href="install_tools.html#install_avarice">Installation</a><br  />
  </dd>
</dl>
<h1><a class="anchor" id="install_unix"></a>
Building and Installing under Linux, FreeBSD, and Others</h1>
<p>The default behaviour for most of these tools is to install every thing under the <code>/usr/local</code> directory. In order to keep the AVR tools separate from the base system, it is usually better to install everything into <code>/usr/local/avr</code>. If the <code>/usr/local/avr</code> directory does not exist, you should create it before trying to install anything. You will need <code>root</code> access to install there. If you don't have or want root access to the system, you can alternatively install in your home directory, for example, in <code>$HOME/local/avr</code>. Where you install is a completely arbitrary decision, but should be consistent for all the tools.</p>
<dl class="section warning"><dt>Warning</dt><dd>If you have <code>CC</code> set to anything other than <code>avr-gcc</code> in your environment, this will cause the configure script to fail. It is best to not have <code>CC</code> set at all.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>It is usually the best to use the latest released version of each of the tools.</dd></dl>
<h2><a class="anchor" id="install_preparations"></a>
Preparations</h2>
<h3><a class="anchor" id="install_host_tools"></a>
Required Tools on the Build Machine</h3>
<p>In order to be able to build and install the compiler and other tools, the build machine requires some software packages. The <a href="https://gcc.gnu.org/wiki/cauldron2023talks?action=AttachFile&amp;do=view&amp;target=2023-Cauldron-Getting-Started-session.pdf">Debian package list</a> is something like:</p>
<ul>
<li>perl gawk binutils gcc-multilib python3 python3-pip gzip make tar zstd autoconf automake gettext gperf dejagnu autogen guile-3.0 expect tcl flex texinfo git diffutils patch git-email</li>
</ul>
<h3><a class="anchor" id="install_location"></a>
Install Location</h3>
<p>You specify the installation directory by using the <code>--prefix=dir</code> option with the <code>configure</code> script. It is important to install all the AVR tools in the same directory or some of the tools will not work correctly. To ensure consistency and simplify the discussion, we will use <code>$PREFIX</code> to refer to whatever directory you wish to install in. You can set this as an environment variable if you wish as such (using a Bourne-like shell):</p>
<p><a id="a4_:24PREFIX" name="a4_:24PREFIX"></a> <a id="a5_--prefix" name="a5_--prefix"></a> </p><pre class="fragment">$ PREFIX=$HOME/local/avr
$ export PREFIX
</pre><p><a id="a6_:24PATH" name="a6_:24PATH"></a> <a class="anchor" id="path"></a></p><dl class="section note"><dt>Note</dt><dd>Be sure that you have your <code>PATH</code> environment variable set to search the directory you install everything in <em>before</em> you start installing anything. For example, if you use <code>--prefix=$PREFIX</code>, you must have <code>$PREFIX/bin</code> in your exported <code>PATH</code>. As such:</dd></dl>
<pre class="fragment">$ PATH=$PATH:$PREFIX/bin
$ export PATH
</pre><h3><a class="anchor" id="install_dir_layout"></a>
Directory Layout</h3>
<p>The instructions below build Binutils, GCC and AVR-LibC <em>outside</em> of the source tree, because:</p>
<ul>
<li>When something goes wrong, you can just remove the build directory and start all over again with a fresh build folder.</li>
<li>You may want to build the tools with different configure options, e.g. build the tools for a Linux host and then build a <a class="el" href="install_tools.html#install_canadian">Canadian cross</a> to run on a Windows host.</li>
<li>GCC does not support configuring anywhere in the source tree, so we'll have to use a separate build folder outside the source tree, anyway.</li>
</ul>
<p>The instructions below assume that you have set up a directory tree like </p><pre class="fragment">+--source
+--build
</pre><p> in some place where you have write access, like in your home directory.</p>
<p>After successful downloads and builds, the tree will be something like: </p><pre class="fragment">+--source
|   +--gcc-&lt;version&gt;
|   +--binutils-&lt;version&gt;
|   +--avr-libc-&lt;version&gt;
+-- build
    +--gcc-&lt;version&gt;-avr
    +--binutils-&lt;version&gt;-avr
    +--avr-libc-&lt;version&gt;
</pre><h2><a class="anchor" id="install_avr_binutils"></a>
GNU Binutils for the AVR target</h2>
<p><a id="a7_installation:2C:20binutils" name="a7_installation:2C:20binutils"></a></p>
<p>The <b>Binutils</b> package provides all the low-level utilities needed in building and manipulating object files. Once installed, your environment will have an AVR assembler (<code><a class="el" href="using_tools.html#using_avr_as">avr-as</a></code>), linker (<code><a class="el" href="using_tools.html#using_avr_ld">avr-ld</a></code>), and librarian (<code>avr-ar</code> and <code>avr-ranlib</code>). In addition, you get tools which extract data from object files (<code>avr-objcopy</code>), disassemble object file information (<code>avr-objdump</code>), and strip information from object files (<code>avr-strip</code>). Before we can build the C compiler, these tools need to be in place.</p>
<p>Download and unpack the source files:</p>
<pre class="fragment">$ # in ./source
$ tar xfj binutils-&lt;version&gt;.tar.bz2
</pre><p>Replace <code>&lt;version&gt;</code> with the version of the package you downloaded.</p>
<p>If you obtained a gzip compressed file (<code>.tar.gz</code> or .tgz), use <code>gunzip</code> instead of <code>bunzip2</code>, or <code>tar xfz <em>file</em>.tar.gz</code>.</p>
<p>The next step is to configure and build the tools. This is done by supplying arguments to the <code>configure</code> script that enable the AVR-specific options. When you also want GDB, just drop <code>--disable-gdb</code>.</p>
<pre class="fragment">$ # in ./build
$ mkdir binutils-&lt;version&gt;-avr
$ cd binutils-&lt;version&gt;-avr
$ ../../source/binutils-&lt;version&gt;/configure --prefix=$PREFIX --target=avr \
    --disable-nls --disable-sim --disable-gdb --disable-werror
</pre><p>When <code>configure</code> is run, it generates a lot of messages while it determines what is available on your operating system. When it finishes, it will have created several <code>Makefile</code>s that are custom tailored to your platform and that are run with the <code>make</code> command.</p>
<pre class="fragment">$ make
</pre><dl class="section note"><dt>Note</dt><dd>BSD users should note that the project's <code>Makefile</code> uses GNU make syntax. This means FreeBSD users may need to build the tools by using <code>gmake</code>.</dd></dl>
<p>If the tools compiled cleanly, you're ready to install them. If you specified a destination that isn't owned by your account, you'll need <code>root</code> access to install them. To install:</p>
<pre class="fragment">$ make install
</pre><p>You should now have the programs from Binutils installed into <code>$PREFIX/bin</code>. Don't forget to <a class="el" href="install_tools.html#path">set your PATH</a> environment variable before going to build avr-gcc. To check that the correct assembler is found, run </p><pre class="fragment">$ avr-as --version
</pre><p> which should print the <code>&lt;version&gt;</code> of the used Binutils sources.</p>
<h2><a class="anchor" id="install_avr_gcc"></a>
GCC for the AVR target</h2>
<p><a id="a8_installation:2C:20gcc" name="a8_installation:2C:20gcc"></a></p>
<dl class="section warning"><dt>Warning</dt><dd>You <b>must</b> install <a class="el" href="install_tools.html#install_avr_binutils">avr-binutils</a> and make sure your <a class="el" href="install_tools.html#path">path is set</a> properly before installing avr-gcc.</dd></dl>
<p>Before we can configure the compiler, we have to prepare the sources. GCC depends on some external host libraries, namely <a href="https://gmplib.org">GMP</a>, <a href="https://www.mpfr.org">MPFR</a>, <a href="https://www.multiprecision.org">MPC</a> and <a href="https://libisl.sourceforge.io">ISL</a>. You can build and install the appropriate versions of the required prerequisites by hand and provide their location by means of <code>--with-gmp=</code> etc. Though in most situations it is easier to let GCC download and build these libraries as part of the configure and build process. All what's needed is an internet connection when running <code>./contrib/download_prerequisites</code>:</p>
<pre class="fragment">$ # in ./source
$ tar xfj gcc-&lt;version&gt;.tar.bz2
$ cd gcc-&lt;version&gt;
$ ./contrib/download_prerequisites

$ # in ./build
$ mkdir gcc-&lt;version&gt;-avr
$ cd gcc-&lt;version&gt;-avr
$ ../../source/gcc-&lt;version&gt;/configure --prefix=$PREFIX --target=avr --enable-languages=c,c++ \
    --disable-nls --disable-libssp --disable-libcc1 \
    --with-gnu-as --with-gnu-ld --with-dwarf2
$ make
$ make install # or make install-strip
</pre><p>The GCC binaries may consume quite some disc space. In most cases, you don't need the debug information in the compiler proper, and installing with </p><pre class="fragment">$ make install-strip
</pre><p> can save you some space.</p>
<h2><a class="anchor" id="install_avr_libc"></a>
AVR-LibC</h2>
<p><a id="a9_installation:2C:20avr-libc" name="a9_installation:2C:20avr-libc"></a></p>
<dl class="section warning"><dt>Warning</dt><dd>You <b>must</b> install <a class="el" href="install_tools.html#install_avr_binutils">avr-binutils</a>, <a class="el" href="install_tools.html#install_avr_gcc">avr-gcc</a> and make sure your <a class="el" href="install_tools.html#path">path is set</a> properly before installing AVR-LibC.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If you have obtained the latest AVR-LibC from <a class="el" href="install_tools.html#using_git">git</a>, you will have to run the <code>./bootstrap</code> script before using either of the build methods described below.</dd></dl>
<p>To build and install AVR-LibC:</p>
<pre class="fragment">$ # in ./source
$ tar xfz avr-libc-&lt;version&gt;.tar.gz

$ # in ./build
$ mkdir avr-libc-&lt;version&gt;
$ cd avr-libc-&lt;version&gt;
$ ../../source/avr-libc-&lt;version&gt;/configure --prefix=$PREFIX \
    --build=x86_64-pc-linux-gnu --host=avr
$ make
$ make install
</pre><p>Where the <code>--build</code> platform can be guessed by running </p><pre class="fragment">$ ./source/avr-libc-&lt;version&gt;/config.guess
</pre><p>When you want to build and install with extra options, you can for example: </p><pre class="fragment">$ make CFLAGS=-Werror CCASFLAGS=-Werror
$ make install prefix=/home/me/install/my-avr-gcc
</pre><h2><a class="anchor" id="install_avrprog"></a>
AVRDUDE</h2>
<p><a id="a10_installation:2C:20avrprog" name="a10_installation:2C:20avrprog"></a> <a id="a11_installation:2C:20avrdude" name="a11_installation:2C:20avrdude"></a></p>
<dl class="section note"><dt>Note</dt><dd>It has been ported to windows (via MinGW or cygwin), Linux and Solaris. Other Unix systems should be trivial to port to.</dd></dl>
<p><code><b>avrdude</b></code> is part of the FreeBSD ports system. To install it, simply do the following:</p>
<pre class="fragment"># cd /usr/ports/devel/avrdude
# make install
</pre><dl class="section note"><dt>Note</dt><dd>Installation into the default location usually requires root permissions. However, running the program only requires access permissions to the appropriate <code>ppi(4)</code> device.</dd></dl>
<p>Building and installing on other systems should use the <code>configure</code> system, as such:</p>
<pre class="fragment">$ gunzip -c avrdude-&lt;version&gt;.tar.gz | tar xf -
$ cd avrdude-&lt;version&gt;
$ mkdir obj-avr
$ cd obj-avr
$ ../configure --prefix=$PREFIX
$ make
$ make install
</pre><h2><a class="anchor" id="install_simulavr"></a>
SimulAVR</h2>
<p><a id="a12_installation:2C:20simulavr" name="a12_installation:2C:20simulavr"></a></p>
<p>SimulAVR also uses the <code>configure</code> system, so to build and install:</p>
<pre class="fragment">$ gunzip -c simulavr-&lt;version&gt;.tar.gz | tar xf -
$ cd simulavr-&lt;version&gt;
$ mkdir obj-avr
$ cd obj-avr
$ ../configure --prefix=$PREFIX
$ make
$ make install
</pre><dl class="section note"><dt>Note</dt><dd>You might want to have already installed <a class="el" href="install_tools.html#install_avr_binutils">avr-binutils</a>, <a class="el" href="install_tools.html#install_avr_gcc">avr-gcc</a> and <a class="el" href="install_tools.html#install_avr_libc">AVR-LibC</a> if you want to have the test programs built in the simulavr source.</dd></dl>
<h2><a class="anchor" id="install_avarice"></a>
AVaRICE</h2>
<p><a id="a13_installation:2C:20avarice" name="a13_installation:2C:20avarice"></a></p>
<dl class="section note"><dt>Note</dt><dd>These install notes are not applicable to avarice-1.5 or older. You probably don't want to use anything that old anyways since there have been many improvements and bug fixes since the 1.5 release.</dd></dl>
<p>AVaRICE also uses the <code>configure</code> system, so to build and install:</p>
<pre class="fragment">$ gunzip -c avarice-&lt;version&gt;.tar.gz | tar xf -
$ cd avarice-&lt;version&gt;
$ mkdir obj-avr
$ cd obj-avr
$ ../configure --prefix=$PREFIX
$ make
$ make install
</pre><dl class="section note"><dt>Note</dt><dd>AVaRICE uses the BFD library for accessing various binary file formats. You may need to tell the configure script where to find the lib and headers for the link to work. This is usually done by invoking the configure script like this (Replace <code>&lt;hdr_path&gt;</code> with the path to the <code>bfd.h</code> file on your system. Replace <code>&lt;lib_path&gt;</code> with the path to <code>libbfd.a</code> on your system.):</dd></dl>
<pre class="fragment">$ CPPFLAGS=-I&lt;hdr_path&gt; LDFLAGS=-L&lt;lib_path&gt; ../configure --prefix=$PREFIX
</pre><h1><a class="anchor" id="install_windows"></a>
Building and Installing under Windows</h1>
<p>Building and installing the toolchain under Windows requires more effort because all of the tools required for building, and the programs themselves, are mainly designed for running under a POSIX environment such as Unix and Linux. Windows does not natively provide such an environment.</p>
<p>There are two projects available that provide such an environment, Cygwin and MinGW. There are advantages and disadvantages to both. Cygwin provides a very complete POSIX environment that allows one to build many Linux based tools from source with very little or no source modifications. However, POSIX functionality is provided in the form of a DLL that is linked to the application. This DLL has to be redistributed with your application and there are issues if the Cygwin DLL already exists on the installation system and different versions of the DLL. On the other hand, MinGW can compile code as native Win32 applications. However, this means that programs designed for Unix and Linux (i.e. that use POSIX functionality) will not compile as MinGW does not provide that POSIX layer for you. Therefore most programs that compile on both types of host systems, usually must provide some sort of abstraction layer to allow an application to be built cross-platform.</p>
<p>MinGW does provide somewhat of a POSIX environment, called MSYS, that allows you to build Unix and Linux applications as they would normally do, with a <code>configure</code> step and a <code>make</code> step. Cygwin also provides such an environment. This means that building the AVR toolchain is very similar to how it is built in Linux, described above. The main differences are in what the PATH environment variable gets set to, pathname differences, and the tools that are required to build the projects under Windows. We'll take a look at the tools next.</p>
<h2><a class="anchor" id="install_windows_tools"></a>
Tools Required for Building the Toolchain for Windows</h2>
<p>These are the tools that are currently used to build an AVR tool chain. This list may change, either the version of the tools, or the tools themselves, as improvements are made.</p>
<dl>
<dt>MinGW </dt>
<dd><p class="startdd">Download the MinGW Automated Installer, 2013-10-04 (or later) <a href="https://sourceforge.net/projects/mingw/files">https://sourceforge.net/projects/mingw/files</a></p><ul>
<li>Run <code>mingw-get-setup.exe</code></li>
<li>In the installation wizard, keep the default values and press the "Next" button for all installer pages except for the pages explicitly listed below.</li>
<li>In the installer page "Repository Catalogues", select the "Download latest
    repository catalogues" radio button, and press the "Next" button</li>
<li>In the installer page "License Agreement", select the "I accept
    the agreement" radio button, and press the "Next" button</li>
<li>In the installer page "Select Components", be sure to select these items:<ul>
<li>C compiler (default checked)</li>
<li>C++ compiler</li>
<li>Ada compiler</li>
<li>MinGW Developer Toolkit (which includes "MSYS Basic System").</li>
</ul>
</li>
<li>Install. </li>
</ul>
<p class="enddd"></p>
</dd>
<dt>Install Cygwin </dt>
<dd>Install everything, all users, UNIX line endings. This will take a <em>long</em> time. A fat internet pipe is highly recommended. It is also recommended that you download all to a directory first, and then install from that directory to your machine.  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>GMP, MPFR, MPC and ISL are required to build GCC. By far the easiest way to use them is by letting GCC download the sources locally by means of running the <code>./contrib/download_prewrequisites</code> script from the GCC top source. GCC will configure and build these libs during <code>configure</code> and <code>make</code>.</dd>
<dd>
Doxygen is required to build AVR-LibC documentation.<ul>
<li><b>Install Doxygen</b><br  />
<ul>
<li>Version 1.7.2</li>
<li><a href="https://www.doxygen.nl">https://www.doxygen.nl</a></li>
<li>Download and install.</li>
</ul>
</li>
</ul>
</dd>
<dd>
NetPBM is required to build graphics in the AVR-LibC documentation.<ul>
<li><b>Install NetPBM</b><br  />
<ul>
<li>Version 10.27.0</li>
<li>From the GNUWin32 project: <a href="http://gnuwin32.sourceforge.net/packages.html">http://gnuwin32.sourceforge.net/packages.html</a></li>
<li>Download and install.</li>
</ul>
</li>
</ul>
</dd>
<dd>
fig2dev is required to build graphics in the AVR-LibC documentation.<ul>
<li><b>Install fig2dev</b><br  />
<ul>
<li>Version 3.2 patchlevel 5c</li>
<li>From WinFig 4.62: <a href="http://winfig.com/downloads">http://winfig.com/downloads</a></li>
<li>Download the zip file version of WinFig</li>
<li>Unzip the download file and install fig2dev.exe in a location of your choice, somewhere in the PATH.</li>
<li>You may have to unzip and install related DLL files for fig2dev. In the version above, you have to install QtCore4.dll and QtGui4.dll.</li>
</ul>
</li>
</ul>
</dd>
<dd>
MikTeX is required to build various documentation.<ul>
<li><b>Install MiKTeX</b><br  />
<ul>
<li>Version 2.9</li>
<li><a href="https://miktex.org">https://miktex.org</a></li>
<li>Download and install.</li>
</ul>
</li>
</ul>
</dd>
<dd>
Ghostscript is required to build various documentation.<ul>
<li><b>Install Ghostscript</b><br  />
<ul>
<li>Version 9.00</li>
<li><a href="https://www.ghostscript.com">https://www.ghostscript.com</a></li>
<li>Download and install.</li>
<li>In the \bin subdirectory of the installation, copy gswin32c.exe to gs.exe.</li>
</ul>
</li>
<li>Set the <code>TEMP</code> and <code>TMP</code> environment variables to <b><code>c:\\temp</code></b> or to the short filename version. This helps to avoid NTVDM errors during building.</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="install_windows_building"></a>
Building the Toolchain for Windows</h2>
<p>All directories in the PATH environment variable should be specified using their short filename (8.3) version. This will also help to avoid NTVDM errors during building. These short filenames can be specific to each machine.</p>
<p>Build the tools below in MinGW/MSYS.</p>
<ul>
<li><b>Binutils</b><br  />
<ul>
<li>Open source code package and patch as necessary.</li>
<li>Configure and build in a directory outside of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>&lt;ghostscript executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>/mingw/bin</li>
<li>c:/cygwin/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Configure <pre class="fragment">CFLAGS=-D__USE_MINGW_ACCESS  \
../$archivedir/configure \
    --prefix=$installdir \
    --target=avr \
    --disable-nls \
    --enable-doc \
    --datadir=$installdir/doc/binutils \
    2&gt;&amp;1 | tee binutils-configure.log</pre></li>
<li>Make <pre class="fragment">make all html install install-html 2&gt;&amp;1 | tee binutils-make.log</pre></li>
<li>Manually change documentation location.</li>
</ul>
</li>
<li><b>GCC</b><br  />
<ul>
<li>Open source code package and patch as necessary.</li>
<li>Configure and build in a directory outside of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>&lt;ghostscript executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>/mingw/bin</li>
<li>c:/cygwin/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Configure <pre class="fragment">LDFLAGS='-L /usr/local/lib -R /usr/local/lib' \
CFLAGS='-D__USE_MINGW_ACCESS'  \
../gcc-$version/configure \
    --prefix=$installdir \
    --target=$target \
    --enable-languages=c,c++ \
    --with-dwarf2 \
    --enable-doc \
    --with-docdir=$installdir/doc/$project \
    --disable-shared \
    --disable-libada \
    --disable-libssp \
    --disable-libcc1 \
    --disable-nls \
    2&gt;&amp;1 | tee $project-configure.log</pre></li>
<li>Make <pre class="fragment">make all html install 2&gt;&amp;1 | tee $package-make.log</pre></li>
</ul>
</li>
<li><b>AVR-LibC</b><br  />
<ul>
<li>Open source code package.</li>
<li>Configure and build at the top of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>/usr/local/bin</li>
<li>/mingw/bin</li>
<li>/bin</li>
<li>&lt;MikTex executables&gt;</li>
<li>&lt;install directory&gt;/bin</li>
<li>&lt;Doxygen executables&gt;</li>
<li>&lt;NetPBM executables&gt;</li>
<li>&lt;fig2dev executable&gt;</li>
<li>&lt;Ghostscript executables&gt;</li>
<li>c:/cygwin/bin</li>
</ul>
</li>
<li>Configure <pre class="fragment">./configure \
    --host=avr \
    --prefix=$installdir \
    --enable-doc \
    --disable-versioned-doc \
    --enable-html-doc \
    --enable-pdf-doc \
    --enable-man-doc \
    --mandir=$installdir/man \
    --datadir=$installdir \
    2&gt;&amp;1 | tee $package-configure.log</pre></li>
<li>Make <pre class="fragment">make all install 2&gt;&amp;1 | tee $package-make.log</pre></li>
<li>Manually change location of man page documentation.</li>
<li>Move the examples to the top level of the install tree.</li>
<li>Convert line endings in examples to Windows line endings.</li>
<li>Convert line endings in header files to Windows line endings.</li>
</ul>
</li>
<li><b>AVRDUDE</b><br  />
<ul>
<li>Open source code package.</li>
<li>Configure and build at the top of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>/mingw/bin</li>
<li>c:/cygwin/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Set location of LibUSB headers and libraries <pre class="fragment">export CPPFLAGS="-I../../libusb-win32-device-bin-$libusb_version/include"
export CFLAGS="-I../../libusb-win32-device-bin-$libusb_version/include"
export LDFLAGS="-L../../libusb-win32-device-bin-$libusb_version/lib/gcc"</pre></li>
<li>Configure <pre class="fragment">./configure \
    --prefix=$installdir \
    --datadir=$installdir \
    --sysconfdir=$installdir/bin \
    --enable-doc \
    --disable-versioned-doc \
    2&gt;&amp;1 | tee $package-configure.log</pre></li>
<li>Make <pre class="fragment">make -k all install 2&gt;&amp;1 | tee $package-make.log</pre></li>
<li>Convert line endings in avrdude config file to Windows line endings.</li>
<li>Delete backup copy of avrdude config file in install directory if exists.</li>
</ul>
</li>
<li><b>Insight/GDB</b><br  />
<ul>
<li>Open source code package and patch as necessary.</li>
<li>Configure and build in a directory outside of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>/mingw/bin</li>
<li>c:/cygwin/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Configure <pre class="fragment">CFLAGS=-D__USE_MINGW_ACCESS  \
LDFLAGS='-static' \
../$archivedir/configure \
    --prefix=$installdir \
    --target=avr \
     --with-gmp=/usr/local \
     --with-mpfr=/usr/local \
     --enable-doc \
     2&gt;&amp;1 | tee insight-configure.log</pre></li>
<li>Make <pre class="fragment">make all install 2&gt;&amp;1 | tee $package-make.log</pre></li>
</ul>
</li>
<li><b>SRecord</b><br  />
<ul>
<li>Open source code package.</li>
<li>Configure and build at the top of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>/mingw/bin</li>
<li>c:/cygwin/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Configure <pre class="fragment">./configure \
    --prefix=$installdir \
    --infodir=$installdir/info \
    --mandir=$installdir/man \
    2&gt;&amp;1 | tee $package-configure.log</pre></li>
<li>Make <pre class="fragment">make all install 2&gt;&amp;1 | tee $package-make.log</pre></li>
</ul>
</li>
</ul>
<p>Build the tools below in Cygwin.</p>
<ul>
<li><b>AVaRICE</b><br  />
<ul>
<li>Open source code package.</li>
<li>Configure and build in a directory outside of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Set location of LibUSB headers and libraries <pre class="fragment">export CPPFLAGS=-I$startdir/libusb-win32-device-bin-$libusb_version/include
export CFLAGS=-I$startdir/libusb-win32-device-bin-$libusb_version/include
export LDFLAGS="-static -L$startdir/libusb-win32-device-bin-$libusb_version/lib/gcc "</pre></li>
<li>Configure <pre class="fragment">../$archivedir/configure \
    --prefix=$installdir \
    --datadir=$installdir/doc \
    --mandir=$installdir/man \
    --infodir=$installdir/info \
    2&gt;&amp;1 | tee avarice-configure.log</pre></li>
<li>Make <pre class="fragment">make all install 2&gt;&amp;1 | tee avarice-make.log</pre></li>
</ul>
</li>
<li><b>SimulAVR</b><br  />
<ul>
<li>Open source code package.</li>
<li>Configure and build in a directory outside of the source code tree.</li>
<li>Set PATH, in order:<ul>
<li>&lt;MikTex executables&gt;</li>
<li>/usr/local/bin</li>
<li>/usr/bin</li>
<li>/bin</li>
<li>&lt;install directory&gt;/bin</li>
</ul>
</li>
<li>Configure <pre class="fragment">export LDFLAGS="-static"
../$archivedir/configure \
    --prefix=$installdir \
    --datadir=$installdir \
    --disable-tests \
    --disable-versioned-doc \
    2&gt;&amp;1 | tee simulavr-configure.log</pre></li>
<li>Make <pre class="fragment">make -k all install 2&gt;&amp;1 | tee simulavr-make.log
make pdf install-pdf 2&gt;&amp;1 | tee simulavr-pdf-make.log</pre></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="install_canadian"></a>
Canadian Cross Builds</h1>
<p>It is also possible to build avr-gcc for host Windows on a Linux build system. Suppose you have installed a <a href="https://www.mingw-w64.org/downloads"><code>i686-w64-mingw32-gcc</code></a> toolchain that can compile code to run on <code>host=i686-w64-mingw32</code>. Then the steps to build a toolchain for Windows are:</p>
<ol type="1">
<li>Build and install the AVR toolchain for the Linux build machine as explained above. Make sure that running the command <pre class="fragment">avr-gcc --version
</pre> prints the compiler version according to the used GCC sources. The native AVR cross compiler is required during configure and to build the AVR target libraries like libgcc. Similarly, the version of the found AVR Binutils programs must match the version of the used Binutils sources.</li>
<li>Determine the name of the <code>--build</code> platform like <code>x86_64-pc-linux-gnu</code>, for example by running the <code>config.guess</code> script as shipped with the top level GCC sources (and also with Binutils sources, and AVR-LibC sources after <code>./bootstrap</code>).</li>
<li>Use different build and install directories, e.g. <code>./build/binutils-&lt;version&gt;-avr-mingw32</code> to build Binutils and <code>--prefix=$PREFIX-mingw32</code> as install path.</li>
<li>Configure, build and install <b>Binutils</b> and <b>GCC</b> like for the native build, but add the following configure options: <pre class="fragment">--build=x86_64-pc-linux-gnu --host=i686-w64-mingw32
</pre> This assumes that the required host libraries like GMP are being built in one go with the compiler. This is accomplished by running the <code>contrib/download_prerequisites</code> script from the toplevel GCC sources, just like with the native build.</li>
<li>There is no need to build <b>AVR-LibC</b> again because it is a pure target library. It can be installed by means of running <pre class="fragment">$ # in ./build/avr-libc-&lt;version&gt;
$ make install prefix=$PREFIX-mingw32
</pre></li>
</ol>
<p>In order to "install" the toolchain on Windows, the canadian cross installed in <code>$PREFIX-mingw32</code> can be moved to the desired location on the Windows computer. The compiler can be used by calling it by its absolute path, or by adding the <code>$PREFIX-mingw32/bin</code> directory to the <code>PATH</code> environment variable.</p>
<h1><a class="anchor" id="using_git"></a>
Using Git</h1>
<p>Most of the sources of the projects above are now managed with the <a href="https://git-scm.com">git</a> distributed version-control tools. When you want to build from the newest development branch, you can clone the repo, like with </p><pre class="fragment">$ git clone &lt;repo&gt; [dirname]
</pre><p> Replace <code>&lt;repo&gt;</code> with the URL of the Git repository, e.g. <code>https://github.com/avrdudes/avr-libc.git</code> for AVR-LibC. Notice that when building AVR-LibC from the repo source, you have to run <code>./bootstrap</code> from the top level AVR-LibC sources prior to <code>configure</code>.</p>
<p>Useful options for git clone:</p>
<dl>
<dt><code>dirname</code> </dt>
<dd><p class="startdd">Specify an optional directory name for the cloned repository, like: </p><pre class="fragment">$ git clone https://github.com/avrdudes/avr-libc.git ./source/avr-libc-main</pre><p> Without <code>dirname</code>, the name of the git file like <code>avr-libc</code> is used. </p>
<p class="enddd"></p>
</dd>
<dt><code>--depth 1</code> </dt>
<dd><p class="startdd">An ordinary clone will clone the complete repository with all its branches and their history. To speed up the cloning and save some disc space, you can just clone the top of the history to some depth. </p>
<p class="enddd"></p>
</dd>
<dt><code>--branch <em>branch</em></code> </dt>
<dd><p class="startdd">The default branch is the head of the latest development, which is <code>master</code> for GCC and Binutils, and <code>main</code> for AVR-LibC.</p>
<p class="enddd">When you want a different ref, like GCC's <code>releases/gcc-14</code> for the head of the GCC v14 branch, or <code>releases/gcc-14.1.0</code> for the GCC v14.1 release tag, then you can specify that as <code><em>branch</em></code>. To see the available refs, you can use </p><pre class="fragment">$ git ls-remote &lt;repo&gt;</pre>  </dd>
</dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 27 2025 18:32:02 for AVR-LibC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.6
</small></address>
</body>
</html>
